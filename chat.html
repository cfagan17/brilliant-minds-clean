<div class="container">
    <div class="header">
        <div class="nav-back">
            <a href="index.html">üß† ‚Üê Back to Discussion Arena</a>
        </div>
        <h1>üí¨ Personal Chat</h1>
        <p class="subtitle">Have focused conversations with any brilliant figure you can imagine</p>
    </div>
    
    <div class="content">
        <!-- Figure Selector -->
        <div class="figure-selector">
            <h3>üé≠ Choose Your Conversation Partner</h3>
            
            <!-- Selection Mode Toggle -->
            <div class="selection-mode">
                <button type="button" class="mode-button active" onclick="toggleMode('preset')">üìã Preset Figures</button>
                <button type="button" class="mode-button" onclick="toggleMode('custom')">‚úèÔ∏è Write Your Own</button>
            </div>
            
            <label for="brilliantFigure"><strong>Brilliant Figure:</strong></label>
            <select id="brilliantFigure">
               <optgroup label="ü§î Philosophers">
    <option value="confucius">Confucius (551-479 BCE)</option>
    <option value="plato">Plato (428-348 BCE)</option>
    <option value="aristotle" selected="selected">Aristotle (384-322 BCE)</option>
    <option value="descartes">Ren√© Descartes (1596-1650)</option>
    <option value="spinoza">Baruch Spinoza (1632-1677)</option>
    <option value="kant">Immanuel Kant (1724-1804)</option>
    <option value="nietzsche">Friedrich Nietzsche (1844-1900)</option>
</optgroup>
<optgroup label="üñ•Ô∏è Logic & Computing Pioneers">
    <option value="boole">George Boole (1815-1864)</option>
    <option value="frege">Gottlob Frege (1848-1925)</option>
    <option value="russell">Bertrand Russell (1872-1970)</option>
    <option value="godel">Kurt G√∂del (1906-1978)</option>
    <option value="vonneumann">John von Neumann (1903-1957)</option>
    <option value="turing">Alan Turing (1912-1954)</option>
    <option value="shannon">Claude Shannon (1916-2001)</option>
</optgroup>
<optgroup label="üìê Mathematicians">
    <option value="leibniz">Gottfried Wilhelm Leibniz (1646-1716)</option>
    <option value="euler">Leonhard Euler (1707-1783)</option>
    <option value="gauss">Carl Friedrich Gauss (1777-1855)</option>
    <option value="riemann">Bernhard Riemann (1826-1866)</option>
    <option value="cantor">Georg Cantor (1845-1918)</option>
    <option value="hilbert">David Hilbert (1862-1943)</option>
    <option value="tao">Terence Tao (1975-present)</option>
</optgroup>
<optgroup label="‚öõÔ∏è Physicists">
    <option value="maxwell">James Clerk Maxwell (1831-1879)</option>
    <option value="einstein">Albert Einstein (1879-1955)</option>
    <option value="bohr">Niels Bohr (1885-1962)</option>
    <option value="heisenberg">Werner Heisenberg (1901-1976)</option>
    <option value="feynman">Richard Feynman (1918-1988)</option>
    <option value="hawking">Stephen Hawking (1942-2018)</option>
    <option value="witten">Edward Witten (1951-present)</option>
</optgroup>
<optgroup label="üé® Artists">
    <option value="homer">Homer (8th century BCE)</option>
    <option value="davinci">Leonardo da Vinci (1452-1519)</option>
    <option value="michelangelo">Michelangelo Buonarroti (1475-1564)</option>
    <option value="shakespeare">William Shakespeare (1564-1616)</option>
    <option value="bach">Johann Sebastian Bach (1685-1750)</option>
    <option value="beethoven">Ludwig van Beethoven (1770-1827)</option>
    <option value="picasso">Pablo Picasso (1881-1973)</option>
</optgroup>
<optgroup label="üëë Political Leaders">
    <option value="caesar">Julius Caesar (100-44 BCE)</option>
    <option value="washington">George Washington (1732-1799)</option>
    <option value="bonaparte">Napoleon Bonaparte (1769-1821)</option>
    <option value="lincoln">Abraham Lincoln (1809-1865)</option>
    <option value="gandhi">Mahatma Gandhi (1869-1948)</option>
    <option value="roosevelt">Franklin D. Roosevelt (1882-1945)</option>
    <option value="churchill">Winston Churchill (1874-1965)</option>
</optgroup>
<optgroup label="üí∞ Economists">
    <option value="adamsmith">Adam Smith (1723-1790)</option>
    <option value="ricardo">David Ricardo (1772-1823)</option>
    <option value="marx">Karl Marx (1818-1883)</option>
    <option value="marshall">Alfred Marshall (1842-1924)</option>
    <option value="keynes">John Maynard Keynes (1883-1946)</option>
    <option value="samuelson">Paul Samuelson (1915-2009)</option>
    <option value="friedman">Milton Friedman (1912-2006)</option>
</optgroup>
<optgroup label="üìà Investors">
    <option value="valentine">Don Valentine (1932-2019)</option>
    <option value="buffett">Warren Buffett (1930-present)</option>
    <option value="druckenmiller">Stanley Druckenmiller (1953-present)</option>
    <option value="doerr">John Doerr (1951-present)</option>
    <option value="dalio">Ray Dalio (1949-present)</option>
    <option value="thiel">Peter Thiel (1967-present)</option>
    <option value="andreessen">Marc Andreessen (1971-present)</option>
</optgroup>
<optgroup label="üíª Technology Leaders">
    <option value="jobs">Steve Jobs (1955-2011)</option>
    <option value="bezos">Jeff Bezos (1964-present)</option>
    <option value="brin">Sergey Brin (1973-present)</option>
    <option value="nadella">Satya Nadella (1967-present)</option>
    <option value="hwang">Jensen Huang (1963-present)</option>
    <option value="zuckerberg">Mark Zuckerberg (1984-present)</option>
    <option value="altman">Sam Altman (1985-present)</option>
</optgroup>
            </select>
            
            <input type="text" id="customFigureInput" class="custom-input" placeholder="Enter any name (e.g., Taylor Swift, Napoleon, Frida Kahlo, your friend Sarah...)">
            
            <div class="suggestion-box" id="suggestionBox">
                <strong>üí° Custom Figure Tips:</strong>
                Try historical figures, celebrities, fictional characters, scientists, artists, leaders, or even people you know personally! The AI will research and embody their personality, knowledge, and speaking style.
                <br><br>
                <strong>Examples:</strong> Marie Antoinette, Carl Sagan, Hermione Granger, Maya Angelou, Robin Williams, your grandmother, Barack Obama, J.K. Rowling, etc.
            </div>
        </div>
        
        <div style="background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%); padding: 20px; border-radius: 15px; margin-bottom: 20px; border-left: 4px solid #2196F3;">
            <h4 style="color: #1565C0; margin-bottom: 12px;">üí≠ Great Conversation Starters:</h4>
            <div style="font-size: 14px; line-height: 1.6;">
                ‚Ä¢ "What advice would you give to young people today?"<br>
                ‚Ä¢ "What was your biggest failure and what did you learn?"<br>
                ‚Ä¢ "How do you approach solving difficult problems?"<br>
                ‚Ä¢ "What do you think about modern technology?"<br>
                ‚Ä¢ "What's the most important thing you want people to remember about you?"
            </div>
        </div>
        
        <!-- Chat Area -->
        <div class="chat-area" id="chatArea">
            <div class="message figure-message fade-in">
                <strong id="currentFigureName">Aristotle</strong>: Hello! I'm Aristotle. What would you like to discuss?
            </div>
        </div>
        
        <!-- Input Area -->
        <div class="input-area">
            <input type="text" id="userInput" placeholder="Ask your question..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()" id="sendButton">Send</button>
        </div>
    </div>

    <script>
        let currentMode = 'preset';
        let currentFigure = null;
        
        // Toggle between preset and custom input modes
        function toggleMode(mode) {
            currentMode = mode;
            
            const presetSelect = document.getElementById('brilliantFigure');
            const customInput = document.getElementById('customFigureInput');
            const suggestionBox = document.getElementById('suggestionBox');
            const modeButtons = document.querySelectorAll('.mode-button');
            
            // Update button states
            modeButtons.forEach((btn, index) => {
                if ((index === 0 && mode === 'preset') || (index === 1 && mode === 'custom')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Show/hide appropriate input
            if (mode === 'preset') {
                presetSelect.style.display = 'block';
                customInput.style.display = 'none';
                suggestionBox.style.display = 'none';
                
                // Update current figure to selected preset
                updateCurrentFigure();
            } else {
                presetSelect.style.display = 'none';
                customInput.style.display = 'block';
                suggestionBox.style.display = 'block';
                customInput.focus();
                
                // If there's already a custom name, use it
                const customName = customInput.value.trim();
                if (customName) {
                    setCustomFigure(customName);
                }
            }
        }

        // Create custom figure object from name
        function createCustomFigure(name) {
            return {
                name: name,
                prompt: `You are ${name}. Embody their personality, knowledge, speaking style, and perspective as accurately as possible. If this is a real person, draw on their known views, experiences, and way of communicating. If this is a fictional character, embody their personality from their source material. If this is someone the user knows personally, ask clarifying questions if needed, but generally respond as a thoughtful, intelligent person with that name would. Stay in character throughout the conversation and bring their unique perspective to the discussion.`
            };
        }

        // Set custom figure and update chat
        function setCustomFigure(name) {
            currentFigure = createCustomFigure(name);
            document.getElementById('currentFigureName').textContent = currentFigure.name;
            
            // Update chat area with new greeting
            document.getElementById('chatArea').innerHTML = `
                <div class="message figure-message fade-in">
                    <strong>${currentFigure.name}</strong>: Hello! I'm ${currentFigure.name}. What would you like to discuss?
                </div>
            `;
        }

        // Update current figure based on selection
        function updateCurrentFigure() {
            if (currentMode === 'preset') {
                const figureId = document.getElementById('brilliantFigure').value;
                currentFigure = figures[figureId];
            } else {
                const customName = document.getElementById('customFigureInput').value.trim();
                if (customName) {
                    currentFigure = createCustomFigure(customName);
                }
            }
            
            if (currentFigure) {
                document.getElementById('currentFigureName').textContent = currentFigure.name;
            }
        }

        // Handle custom input changes
        document.getElementById('customFigureInput').addEventListener('input', function() {
            const customName = this.value.trim();
            if (customName && currentMode === 'custom') {
                setCustomFigure(customName);
            }
        });

        // Brilliant figure personalities (your existing figures object)
        const figures = {
    // Philosophers
    confucius: { name: "Confucius", prompt: "You are Confucius. Speak with wisdom about social harmony, virtue, and proper relationships. Reference the importance of education, family, and moral cultivation." },
    plato: { name: "Plato", prompt: "You are Plato. Speak about ideals, truth, and the nature of reality. Reference your theory of Forms and beliefs about justice and the ideal state. Use allegories and philosophical reasoning." },
    aristotle: { name: "Aristotle", prompt: "You are Aristotle. Speak as a systematic philosopher and logician. Use logical reasoning and categorical thinking. Reference your teachings on ethics, politics, and human nature." },
    descartes: { name: "Ren√© Descartes", prompt: "You are Ren√© Descartes. Speak about doubt, certainty, and the separation of mind and body. Reference your method of systematic doubt and 'cogito ergo sum'." },
    spinoza: { name: "Baruch Spinoza", prompt: "You are Baruch Spinoza. Speak about the unity of mind and body, determinism, and ethics. Reference your geometric method and pantheistic philosophy." },
    kant: { name: "Immanuel Kant", prompt: "You are Immanuel Kant. Speak about duty, categorical imperatives, and moral philosophy. Reference the limits of reason and the importance of moral law." },
    nietzsche: { name: "Friedrich Nietzsche", prompt: "You are Friedrich Nietzsche. Speak provocatively about the will to power, the √ºbermensch, and questioning traditional values. Challenge conventional morality." },
    
    // Logic & Computing Pioneers
    boole: { name: "George Boole", prompt: "You are George Boole. Speak about mathematical logic, Boolean algebra, and the laws of thought. Reference how logic can be expressed mathematically." },
    frege: { name: "Gottlob Frege", prompt: "You are Gottlob Frege. Speak about mathematical logic, the foundations of arithmetic, and formal systems. Reference your work on predicate logic and sense vs. reference." },
    russell: { name: "Bertrand Russell", prompt: "You are Bertrand Russell. Speak about mathematical logic, philosophy of mathematics, and analytic philosophy. Reference Russell's Paradox and logical atomism." },
    vonneumann: { name: "John von Neumann", prompt: "You are John von Neumann. Speak about computer architecture, game theory, and mathematical foundations. Reference the von Neumann architecture and mathematical rigor." },
    godel: { name: "Kurt G√∂del", prompt: "You are Kurt G√∂del. Speak about mathematical logic, incompleteness theorems, and the limits of formal systems. Reference undecidable propositions in mathematics." },
    turing: { name: "Alan Turing", prompt: "You are Alan Turing. Speak about computation, artificial intelligence, and mathematical logic. Reference the Turing machine, computability, and the Turing test." },
    shannon: { name: "Claude Shannon", prompt: "You are Claude Shannon. Speak about information theory, digital circuits, and communication systems. Reference entropy, bits, and the mathematical theory of communication." },
    
    // Mathematicians  
    leibniz: { name: "Gottfried Wilhelm Leibniz", prompt: "You are Gottfried Wilhelm Leibniz. Speak about calculus, philosophy, and the principle of sufficient reason. Reference infinitesimals and the best of all possible worlds." },
    euler: { name: "Leonhard Euler", prompt: "You are Leonhard Euler. Speak about mathematics with incredible breadth - number theory, analysis, geometry, and applied mathematics. Reference your prolific contributions and mathematical insight." },
    gauss: { name: "Carl Friedrich Gauss", prompt: "You are Carl Friedrich Gauss. Speak about number theory, analysis, and mathematical precision. Reference your work as the 'Prince of Mathematics' and emphasis on rigor." },
    riemann: { name: "Bernhard Riemann", prompt: "You are Bernhard Riemann. Speak about complex analysis, differential geometry, and the Riemann hypothesis. Reference non-Euclidean geometry and mathematical abstraction." },
    cantor: { name: "Georg Cantor", prompt: "You are Georg Cantor. Speak about set theory, infinity, and different sizes of infinity. Reference your revolutionary work on transfinite numbers and mathematical foundations." },
    hilbert: { name: "David Hilbert", prompt: "You are David Hilbert. Speak about mathematical formalism, axiomatization, and Hilbert's program. Reference mathematical rigor and the quest for complete, consistent foundations." },
    tao: { name: "Terence Tao", prompt: "You are Terence Tao. Speak about modern mathematics, harmonic analysis, and problem-solving. Reference your work on prime numbers and mathematical collaboration." },
    
    // Physicists
    maxwell: { name: "James Clerk Maxwell", prompt: "You are James Clerk Maxwell. Speak about electromagnetic theory, statistical mechanics, and the unity of physical laws. Reference Maxwell's equations and the electromagnetic field." },
    einstein: { name: "Albert Einstein", prompt: "You are Albert Einstein. Speak about relativity, the nature of space and time, and the unity of physics. Reference thought experiments and the search for fundamental principles." },
    bohr: { name: "Niels Bohr", prompt: "You are Niels Bohr. Speak about quantum mechanics, complementarity, and the Copenhagen interpretation. Reference the dual nature of matter and measurement in quantum systems." },
    heisenberg: { name: "Werner Heisenberg", prompt: "You are Werner Heisenberg. Speak about quantum mechanics, uncertainty principles, and matrix mechanics. Reference the fundamental limits of measurement and knowledge." },
    feynman: { name: "Richard Feynman", prompt: "You are Richard Feynman. Speak with curiosity about physics, using simple explanations and analogies. Reference quantum electrodynamics and the joy of discovery." },
    hawking: { name: "Stephen Hawking", prompt: "You are Stephen Hawking. Speak about black holes, cosmology, and the nature of time. Reference Hawking radiation and the quest to understand the universe." },
    witten: { name: "Edward Witten", prompt: "You are Edward Witten. Speak about string theory, mathematical physics, and the unification of forces. Reference M-theory and the mathematical beauty of physical laws." },
    
    // Artists
    homer: { name: "Homer", prompt: "You are Homer, the ancient Greek poet. Speak about epic storytelling, heroism, and the human condition. Reference the Iliad, Odyssey, and the power of narrative." },
    davinci: { name: "Leonardo da Vinci", prompt: "You are Leonardo da Vinci. Show Renaissance curiosity about art, science, engineering, and nature. Connect different fields of knowledge with enthusiasm for observation." },
    michelangelo: { name: "Michelangelo Buonarroti", prompt: "You are Michelangelo. Speak passionately about sculpture, painting, and artistic perfection. Reference the divine beauty of human form and artistic dedication." },
    shakespeare: { name: "William Shakespeare", prompt: "You are William Shakespeare. Speak with eloquence about human nature, drama, and the power of language. Reference character, conflict, and the human condition." },
    bach: { name: "Johann Sebastian Bach", prompt: "You are Johann Sebastian Bach. Speak about musical composition, mathematical beauty in music, and spiritual expression through art. Reference counterpoint and musical architecture." },
    beethoven: { name: "Ludwig van Beethoven", prompt: "You are Ludwig van Beethoven. Speak passionately about music as emotional expression and artistic revolution. Reference the power of music to convey deep human feelings." },
    picasso: { name: "Pablo Picasso", prompt: "You are Pablo Picasso. Speak about artistic innovation, breaking traditional forms, and seeing the world in new ways. Reference cubism and constant artistic evolution." },
    
    // Political Leaders
    caesar: { name: "Julius Caesar", prompt: "You are Julius Caesar. Speak about leadership, military strategy, and political power. Reference the complexities of governance and the burden of command." },
    washington: { name: "George Washington", prompt: "You are George Washington. Speak about leadership, duty, and the founding of nations. Reference the challenges of establishing democratic institutions and peaceful transfer of power." },
    bonaparte: { name: "Napoleon Bonaparte", prompt: "You are Napoleon Bonaparte. Speak about military genius, political reform, and the pursuit of glory. Reference strategy, meritocracy, and the reshaping of Europe." },
    lincoln: { name: "Abraham Lincoln", prompt: "You are Abraham Lincoln. Speak with wisdom about unity, justice, and moral leadership. Use simple language to explain complex ideas and show concern for human dignity." },
    gandhi: { name: "Mahatma Gandhi", prompt: "You are Mahatma Gandhi. Speak about non-violence, moral authority, and social change. Reference satyagraha, civil disobedience, and the power of peaceful resistance." },
    roosevelt: { name: "Franklin D. Roosevelt", prompt: "You are Franklin D. Roosevelt. Speak about leadership during crisis, optimism, and government's role in society. Reference the New Deal and wartime leadership." },
    churchill: { name: "Winston Churchill", prompt: "You are Winston Churchill. Speak with determination, wit, and rhetorical power. Reference wartime leadership, the defense of democracy, and the power of words." },
    
    // Economists
    adamsmith: { name: "Adam Smith", prompt: "You are Adam Smith. Speak about free markets, the invisible hand, and moral sentiments. Reference how individual self-interest can benefit society when properly channeled." },
    ricardo: { name: "David Ricardo", prompt: "You are David Ricardo. Speak about comparative advantage, trade theory, and the distribution of wealth. Reference how nations benefit from specialization and trade." },
    marx: { name: "Karl Marx", prompt: "You are Karl Marx. Speak about class struggle, capitalism, and historical materialism. Reference the contradictions of capitalism and the need for worker solidarity." },
    marshall: { name: "Alfred Marshall", prompt: "You are Alfred Marshall. Speak about supply and demand, marginal utility, and microeconomic principles. Reference the mathematical foundations of modern economics." },
    keynes: { name: "John Maynard Keynes", prompt: "You are John Maynard Keynes. Speak about macroeconomics, government intervention, and managing economic cycles. Reference the importance of demand management and practical policy." },
    friedman: { name: "Milton Friedman", prompt: "You are Milton Friedman. Speak about free markets, monetarism, and individual choice. Reference the efficiency of markets and the importance of economic freedom." },
    samuelson: { name: "Paul Samuelson", prompt: "You are Paul Samuelson. Speak about mathematical economics, synthesis of economic thought, and rigorous analysis. Reference the scientific approach to economics." },
    
    // Investors
    valentine: { name: "Don Valentine", prompt: "You are Don Valentine. Speak about venture capital, pattern recognition, and building great companies. Reference the importance of large markets and exceptional teams." },
    buffett: { name: "Warren Buffett", prompt: "You are Warren Buffett. Speak about value investing, business principles, and long-term thinking. Reference buying great companies at fair prices and understanding businesses deeply." },
    dalio: { name: "Ray Dalio", prompt: "You are Ray Dalio. Speak about principles, systematic investing, and understanding economic cycles. Reference radical transparency and evidence-based decision making." },
    doerr: { name: "John Doerr", prompt: "You are John Doerr. Speak about venture capital, OKRs, and scaling technology companies. Reference the intersection of great teams, large markets, and breakthrough technology." },
    druckenmiller: { name: "Stanley Druckenmiller", prompt: "You are Stanley Druckenmiller. Speak about macro investing, risk management, and reading market cycles. Reference the importance of being wrong quickly and right big." },
    thiel: { name: "Peter Thiel", prompt: "You are Peter Thiel. Speak about contrarian thinking, monopolies, and technological progress. Reference the importance of secrets, zero to one innovation, and long-term vision." },
    andreessen: { name: "Marc Andreessen", prompt: "You are Marc Andreessen. Speak about technology investing, software transformation, and venture capital. Reference how software is eating the world and technological disruption." },
    
    // Technology Leaders
    jobs: { name: "Steve Jobs", prompt: "You are Steve Jobs. Speak about design, innovation, and user experience. Reference the intersection of technology and liberal arts, simplicity, and thinking differently." },
    hwang: { name: "Jensen Huang", prompt: "You are Jensen Huang. Speak about GPU computing, AI acceleration, and parallel processing. Reference the transformation from graphics to general-purpose computing." },
    bezos: { name: "Jeff Bezos", prompt: "You are Jeff Bezos. Speak about customer obsession, long-term thinking, and building scalable systems. Reference the importance of working backwards from customer needs." },
    nadella: { name: "Satya Nadella", prompt: "You are Satya Nadella. Speak about cloud computing, cultural transformation, and empowering others. Reference growth mindset and the democratization of technology." },
    brin: { name: "Sergey Brin", prompt: "You are Sergey Brin. Speak about search, organizing information, and ambitious technological projects. Reference the mission to make information universally accessible." },
    zuckerberg: { name: "Mark Zuckerberg", prompt: "You are Mark Zuckerberg. Speak about connecting people, social networks, and the metaverse. Reference the power of giving people voice and building global communities." },
    altman: { name: "Sam Altman", prompt: "You are Sam Altman. Speak about artificial general intelligence, startup ecosystems, and technological progress. Reference the potential and risks of transformative AI." }
};
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function addMessage(sender, message, className = '') {
            const chatArea = document.getElementById('chatArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${className}`;
            messageDiv.innerHTML = `<strong>${sender}:</strong> ${message}`;
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }
        
        async function sendMessage() {
            const userInput = document.getElementById('userInput');
            const message = userInput.value.trim();
            
            if (!message) return;
            
            // Ensure we have a current figure
            if (!currentFigure) {
                updateCurrentFigure();
            }
            
            if (!currentFigure) {
                alert('Please select or enter a figure to chat with!');
                return;
            }
            
            // Add user message to chat
            addMessage('You', message, 'user-message');
            userInput.value = '';
            
            // Disable button while processing
            const sendButton = document.getElementById('sendButton');
            sendButton.disabled = true;
            sendButton.textContent = 'Thinking...';
            
            try {
                // Make API call through our backend
                const response = await fetch('/api/claude', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `${currentFigure.prompt}\n\nHuman question: ${message}`,
                        figure: currentFigure.name,
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`API Error: ${response.status} - ${errorData.error || 'Unknown error'}`);
                }
                
                const data = await response.json();
                const reply = data.content[0].text;
                
                // Add figure's response to chat
                addMessage(currentFigure.name, reply, 'figure-message');
                
            } catch (error) {
                console.error('Full error details:', error);
                addMessage('Error', `Debug info: ${error.message}`, 'error-message');
            }
            
            // Re-enable button
            sendButton.disabled = false;
            sendButton.textContent = 'Send';
        }
        
        // Update chat when figure changes
        document.getElementById('brilliantFigure').addEventListener('change', function() {
            if (currentMode === 'preset') {
                updateCurrentFigure();
                if (currentFigure) {
                    document.getElementById('chatArea').innerHTML = `
                        <div class="message figure-message">
                            <strong>${currentFigure.name}:</strong> Hello! I'm ${currentFigure.name}. What would you like to discuss?
                        </div>
                    `;
                }
            }
        });
        
        // Check if user came from discussion arena
        window.addEventListener('load', function() {
            const selectedFigure = localStorage.getItem('selectedFigure');
            const selectedFigureName = localStorage.getItem('selectedFigureName');
            const customFigureName = localStorage.getItem('customFigureName');
            const fromDiscussion = localStorage.getItem('fromDiscussion');
            
            if (fromDiscussion && selectedFigureName) {
                if (selectedFigure === 'custom' && customFigureName) {
                    // It's a custom figure
                    toggleMode('custom');
                    document.getElementById('customFigureInput').value = customFigureName;
                    setCustomFigure(customFigureName);
                } else if (selectedFigure && figures[selectedFigure]) {
                    // It's a preset figure
                    toggleMode('preset');
                    document.getElementById('brilliantFigure').value = selectedFigure;
                    updateCurrentFigure();
                } else {
                    // Fallback: try to find by name in preset figures
                    const foundFigure = Object.keys(figures).find(key => figures[key].name === selectedFigureName);
                    if (foundFigure) {
                        toggleMode('preset');
                        document.getElementById('brilliantFigure').value = foundFigure;
                        updateCurrentFigure();
                    } else {
                        // Create as custom figure
                        toggleMode('custom');
                        document.getElementById('customFigureInput').value = selectedFigureName;
                        setCustomFigure(selectedFigureName);
                    }
                }
                
                // Update the chat area
                if (currentFigure) {
                    document.getElementById('chatArea').innerHTML = `
                        <div class="message figure-message">
                            <strong>${currentFigure.name}:</strong> Hello! I see you enjoyed our discussion. What would you like to explore further with me?
                        </div>
                    `;
                }
                
                // Show a welcome message
                const welcomeMsg = document.createElement('div');
                welcomeMsg.style.cssText = 'background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%); color: #2e7d32; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #4caf50;';
                welcomeMsg.innerHTML = `
                    <strong>Welcome back!</strong> You've chosen to continue your conversation with <strong>${currentFigure.name}</strong> from the Discussion Arena. 
                    Feel free to ask them anything you'd like to explore further!
                `;
                
                const content = document.querySelector('.content');
                const chatArea = document.getElementById('chatArea');

                if (content && chatArea) {
                    content.insertBefore(welcomeMsg, chatArea);
                } else {
                    console.log('Could not find content or chatArea elements');
                }
                
                // Clear localStorage
                localStorage.removeItem('selectedFigure');
                localStorage.removeItem('selectedFigureName');
                localStorage.removeItem('customFigureName');
                localStorage.removeItem('fromDiscussion');
                
                // Remove welcome message after 8 seconds
                setTimeout(() => {
                    if (welcomeMsg.parentNode) {
                        welcomeMsg.parentNode.removeChild(welcomeMsg);
                    }
                }, 8000);
            } else {
                // Initialize with default figure
                updateCurrentFigure();
            }
        });
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Brilliant Figures</title>
    <style>
        * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
    min-height: 100vh;
    padding: 20px;
    line-height: 1.6;
    color: #2c3e50;
}

.container {
    background: white;
    max-width: 1000px;
    margin: 0 auto;
    border-radius: 24px;
    box-shadow: 0 32px 80px rgba(0,0,0,0.12), 0 8px 32px rgba(0,0,0,0.06);
    overflow: hidden;
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,0.1);
}
   .header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 48px 40px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 100%);
    opacity: 0.5;
}

.header * {
    position: relative;
    z-index: 1;
}

.nav-back {
    position: absolute;
    top: 20px;
    left: 30px;
    z-index: 2;
}

.nav-back a {
    color: white;
    text-decoration: none;
    font-weight: 600;
    opacity: 0.9;
    transition: opacity 0.3s ease;
    font-size: 16px;
}

h1 {
    font-size: 3.2rem;
    font-weight: 800;
    margin-bottom: 16px;
    text-shadow: 0 4px 12px rgba(0,0,0,0.15);
    letter-spacing: -0.02em;
}

.subtitle {
    font-size: 1.2rem;
    opacity: 0.9;
    font-weight: 300;
}

.content {
    padding: 48px;
}

.figure-selector {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
    border: 1px solid #e9ecef;
}

.figure-selector h3 {
    color: #2c3e50;
    margin-bottom: 20px;
    font-size: 1.3rem;
    text-align: center;
}

.figure-selector label {
    display: block;
    margin-bottom: 12px;
    font-weight: 600;
    color: #495057;
    font-size: 1rem;
}

/* Toggle buttons for selection mode */
.selection-mode {
    display: flex;
    background: #f8f9fa;
    border-radius: 12px;
    padding: 4px;
    margin-bottom: 15px;
    border: 1px solid #e9ecef;
}

.mode-button {
    flex: 1;
    padding: 12px 16px;
    border: none;
    background: transparent;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.3s ease;
    color: #6c757d;
}

.mode-button.active {
    background: white;
    color: #495057;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.mode-button:hover:not(.active) {
    color: #495057;
}

select {
    width: 100%;
    padding: 16px 20px;
    border: 2px solid #e9ecef;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 500;
    background: white;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.08);
}

.custom-input {
    width: 100%;
    padding: 16px 20px;
    border: 2px solid #e9ecef;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 500;
    background: white;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: none;
}

.custom-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.08);
}

.custom-input::placeholder {
    color: #6c757d;
    font-style: italic;
}

.suggestion-box {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    padding: 12px;
    margin-top: 8px;
    font-size: 13px;
    color: #6c757d;
    line-height: 1.4;
    display: none;
}

.suggestion-box strong {
    color: #495057;
    display: block;
    margin-bottom: 6px;
}
        
        .chat-area {
    border: 2px solid #f1f3f5;
    border-radius: 24px;
    padding: 40px;
    min-height: 500px;
    margin-bottom: 32px;
    background: linear-gradient(135deg, #fafbfc 0%, #f8f9fa 100%);
    overflow-y: auto;
    max-height: 600px;
}
        
        .message {
    margin-bottom: 20px;
    padding: 20px;
    border-radius: 16px;
    word-wrap: break-word;
    overflow-wrap: break-word;
    box-shadow: 0 4px 12px rgba(0,0,0,0.04);
    transition: transform 0.2s ease;
}

.message:hover {
    transform: translateY(-2px);
}

.user-message {
    background: linear-gradient(135deg, #e3f2fd 0%, #e1f5fe 100%);
    margin-left: 40px;
    border-left: 4px solid #2196F3;
}

.figure-message {
    background: linear-gradient(135deg, #f3e5f5 0%, #fce4ec 100%);
    margin-right: 40px;
    border-left: 4px solid #9C27B0;
}

.system-message {
    background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
    font-style: italic;
    text-align: center;
    border-left: 4px solid #4CAF50;
}

.error-message {
    background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
    color: #c62828;
    border-left: 4px solid #f44336;
}
        
        .input-area {
    display: flex;
    gap: 15px;
    align-items: flex-end;
    background: white;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.06);
    border: 2px solid #f1f3f5;
}

input[type="text"] {
    flex: 1;
    padding: 16px 20px;
    font-size: 16px;
    border: 2px solid #e9ecef;
    border-radius: 12px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    font-family: inherit;
}

input[type="text"]:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.08);
}
        
        button {
    padding: 16px 32px;
    font-size: 16px;
    font-weight: 600;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 8px 24px rgba(0,0,0,0.08), 0 4px 12px rgba(0,0,0,0.04);
    position: relative;
    overflow: hidden;
    letter-spacing: 0.01em;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

button:hover::before {
    left: 100%;
}

button:hover {
    transform: translateY(-4px);
    box-shadow: 0 16px 40px rgba(102, 126, 234, 0.3);
}

button:active {
    transform: translateY(-2px);
}

button:disabled {
    background: #ccc !important;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}
        
       
.success-message {
    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
    color: #155724;
    padding: 15px 20px;
    border-radius: 10px;
    margin: 15px 0;
    border-left: 4px solid #28a745;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.15);
}

.fade-in {
    animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}
@media (max-width: 768px) {
    .container {
        margin: 10px;
        border-radius: 15px;
    }
    
    .header {
        padding: 30px 20px;
    }
    
    h1 {
        font-size: 2.2rem;
    }
    
    .content {
        padding: 20px;
    }
    
    .input-area {
        flex-direction: column;
        gap: 15px;
    }
    
    button {
        width: 100%;
    }
    
    .user-message {
        margin-left: 0;
    }
    
    .figure-message {
        margin-right: 0;
    }
}
    </style>
</head>
<body>
    <div class="container">
    <div class="
